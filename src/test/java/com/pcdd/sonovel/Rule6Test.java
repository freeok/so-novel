/* 2020全面小康 劝进 当代秦二世 公车上书 shuu##kinn##pei 一天游泳一千米 云视察 习殡法 初二圣君 颐指气使 中国离岸隐匿资产管理工作领导小组组组长 習大佬 氼兲嫑炛 近言 瘟疫领主习近平 赵王 习瘟猪 习索里尼 习卒 黑白翠 羽日帝 野心习 退党 习近砰 这个年很静 习二蛋 不同意的举手##没有##没有 包大人 人类命运共同体首席架构师 外交习语 人民领袖 习禁评 格萨尔 核平全世界 维尼DISCO 习“甩锅” 习奥塞斯库 习屎黄 游泳一千米 祈翠語言包 彩色熊 添宪宝宝 国贼习近平 粪坑先生 没规划的葬礼 祈翠 习尿瓶 当皇帝的小丑 朝令夕改 维尼带货 相信有神论的物理学博士 平&强 形式主义防疫 習敗北 小学博士 第一书记王沪宁 习正日 重地之战 宰相 冰棒外交 “复辟” The##Xi##Factor（习近平因素） 动物之森 主席贺词 颐使气指 十一郎习近平 瘟疫降生习近平 戏包皮 总加速师 親自視頻 习孢子 战“疫”金句 仲夏夜之中国梦 維尼頌 皇帝梦 儿童习典 帝皇頌 沼气专家 刁人13 撒币宝 屎侯 席近平 动物庄园 “皇帝梦” 任大炮 XD 习流氓 主席+终身制 信女愿一生吃素 维尼警察（X） 坡涛汹涌 习歪嘴 岿然不动 维尼之声 红旗下的蛋 毛进平 老街 大海掀翻小池塘 维尼挂彩 electron8964 野蛮其体魄 维尼连任 人尽皆知的体育迷 官僚主义 万岁来武汉了 口罩大会 彩色哥 错误执行者 最后领导人 翡翠娘娘 哲欣 Cicada##3301##XD 北红尾鸲 贬词包用 nmslese##dream 红二代 慨撒大帝 黄俄 刁人13 10号跳跳虎被维尼拉清单 人均接近八千万 亲自指挥疫情 毛二习 梦回大清 习二胖 巴拿马文件 20000T麦子 文明其精神 视频看望 不知名氏 xdd 乳包文化 武汉委托李克强 裸宽包子劾心 V尼哥 智商不重要 习特勒 当代秦始皇 WHO的君王 食腐虫 习家军 卡近菲 冤大头 包经 包包大人 Criminal##Xi##"Xitler"##Jinping 墙内人 御板泽民 中国爱非洲 习匪 两会期间+隐瞒 “黄袍加身” 梁家河 读书单 大大招牌 维尼·屎(Winnie##the##Poo) virus##king 孙笑川 你是反贼吗 称帝修宪 shit禁评 包子宪法 《生物安全法》 总统包子习 习包子 假.."~bang！卒 禁评的理由 ChinaXi 習敗敗 耀眼黄红黄 连专家也为之叹服的电脑天才 做N届的主席 九大诉求 习king 亲自封号 闹得欢 习和谐 影子末帝 习习蛤蛤 习厉王 习远凸 bingbang帝 五毛主席 习达姆 总书记来我家 维尼快乐组织（Winnie##Happy##Organization）简称WHO 习武帝 小习微信 刁后主 冲塔 包惠帝 任志强 拉清单 “登基” 东方project 习夶 电脑世代586 支那毒王 “登机”（与登基同音） 糟糕皇帝 满脸喷粪 梁家河贵族 头号球迷 人民战争 习一尊 Adolf##Xitler 平话 习是春绿 韦来书记 习宽衣 役民五术 习时代 Heil##Xitler 大大品牌 匪酋习维尼 维稳警察（O） 习二世胡亥 次级乳包 习言乱语 戏博士 阳台上的哨兵 我是一个足球迷 一带一路 中字头组长 习Core 吸精瓶 毛孙 金科律玉 百万雄师事件 共哀宗 刁斤山 习包皮 字共狗 习近平光辉形象 戴口赵 习大犬 皇帝亲临忠诚的武汉 二百五大帝 亲自删评 包禁评 习卒习 白猪 包皇 太祖兔 天安门合法继承人 刁远山 阿道夫-习 习教父 骑巨龙 日子像蜜甜 终身领导人 号屎洞 XDD 狙击手待命 包帝巡游 习二二（二零二零年五月二十二日开二会） 䒒(tiáo)菦(qín)苹(píng) 4中组长 习驴 墨索里习 刁二婚 基拉大和习近平 捐麦子 亲自指挥 截颈平 半羽习近平 维持会长 第22条军规 习进棺 动物森友会 那翠化 习梦思 包子病毒 习二坐船 庆丰包·勃列日涅夫 习大郎 疯狂宇宙 习思想 习皇帝 武当七侠的政治斗争 习太孑 赵人13 狙击手待命 通商宽衣 小学居士 毛二世 大撒币 屎進瓶 包包侠 野兽先辈 大撒幣 秦城监狱 灰习牛 读稿机 富平学霸刁斤干 倒车 爱新觉罗·近平 习王的田野上 大兔 糖尿维尼 书单吟诵者 人民领袖 习澳塞斯库 大锅瞻遗 北京中南海支部书记 细瓶颈 超邓赶毛 无限连任 指定接班人 “无罩”现身 集金币 vop 近身平A 十日文革 维尼熊给跳跳虎黄牌 背书单 习后主 习猪席 中国首席造梦大师 习是春竹 习三点 维尼梗有害 习蛤 宽衣帝 扛麦帝 足球外交 冠子兵法 习博士 200吨 独彩者 “梦回大清” 维尼写史 习条英机 喷粪帝 习废帝 梦帝 皇帝的新衣 习emperor 国王 shit侯 64岁 习大帝 禁评封号 shit##hole##bing##fa 末代皇帝 亲自脱贫 习包子 蹄防 Voice##of##Pooh 九评 世宗 习张三丰 万岁来武汉 倒车帝 崇祯帝 不敢高声语 习低能儿 包子露宪 嘻包皮 口罩外交 西朝鲜人民自治岛 讨习檄文 鞋哥 庆丰帝的千秋梦 恩重如删 修宪 支那精神野爹 送礼平 习付 洗尽贫 阿平 刁斤二 赵家家仆 腊肉馅儿包子 大国造疫 赵付 毛魔转世 习猪头 倒车斯基 nmslman（习主席） 坟头蹦迪 清华毕业 习总输记 中国离岸隐匿资产管理工作领导小组组组长 SB包子 喜包皮 没有网络安全就没有国家安全 洗包皮 习核心 集金pay 刁槑夶尛 疯狂宇宙大帝 时间控制 刁大犬 大撒币 禁评大帝 親自蒞臨 青年大学包 神明论 习包子 习犬犬 习梦撕 灭共助推器 惜包皮 吃赵弹 野兽主席 夶 习大乞 习皇的新装 不强自息 粪坑兵法 习三拍 头上三尺有神明 孢 宽衣撸绣单肩扛麦光腚拉碾歪脖撒币小学博士帝 习尔布特 尊蛤讨包 世界最强乞丐 习二卒 叩谢习恩 狙击手布阵 每日祈翠 法外狂徒Lucy（德国） “习泽东”和“洪宪”（袁世凯的帝号） 习大 普习金 习奥赛斯库 包子兵法 嬉包皮 庆丰称帝 刁二将 央视姓党 爱新觉罗近平 尼哥 习总 恐惊天上人 胡志平 中国特色射秽煮疫制度 纳翠党 追思焦裕禄 坡涛汹涌 中国拉清单工作领导小组组长 乳制品 清单帝 感恩教育 昆明湖涨潮 习背书 普近 家业论 Mr##Shithole 领袖习澡水 屎禁评 包子金刚腿 厕所革命 习式病毒 习躲躲 系包皮 乳透社##小反旗 维尼史 习大林 专治各种不服 刁近乎 蔡英文最强助选 习公奭 习梦死 抗麦套装 花花公子 习语录 川普的朋友or敌人 习兵法 甩锅侠 习侯 独裁者 维尼熊 386系统驱动游戏 傻大头 疯狂宇宙包 习语 猪禁评 集近闭 Chairman##Xi 通商宽衣 习病法 现任匪首 细颈瓶 断崖式下跌 毛二 东瘟疫之地统治者暨全境守护者 毛近平 共哀宗 悉包皮 学包分子 崇祯 习贼 叩谢习恩 庆丰废物 玉习大帝 武统时代 晚共昏君 邪大大 战疫国 吸包皮 万岁 习老八 席子兵法 修宪连任 裹嘎举吸钢闸门 学包率 疫情蔓延 赛禁评 枪毙名单 亲自考察 习##卡##巴##卡 法习斯 号尿壶公 民进党 塔西佗陷阱 隔离”的金葫芦 新影帝 习匪帝 Corona##Xi（习病毒） 袁世凯第二 总书记来过我的家 720事件 动森 迈克尔·索伊 扛麦郎 恩维尔·霍习 彭主席（习主席走了太太接班） 中国的新皇帝 习下台 维尼大帝 习像章 毛装 赵弹 腊肉包 发皇帝梦 袭包皮 刁近猴 叼斤干 习包子的Fa 老歪脖子树 习得梁家书卷 A##Big##Deal 孤独的毒王 学包积极分子 平平 皇帝亲临忠诚的武汉 习狍 习猪下台 该违禁词汇由 GitCode 官方生成，仅用于测试，请勿传播！ NMSL CoronaXi 习呆呆 近日成 */
package com.pcdd.sonovel;

import cn.hutool.core.io.resource.ResourceUtil;
import cn.hutool.core.text.UnicodeUtil;
import cn.hutool.core.util.ReUtil;
import cn.hutool.http.HtmlUtil;
import cn.hutool.http.HttpRequest;
import cn.hutool.json.JSONObject;
import cn.hutool.json.JSONUtil;
import cn.hutool.script.ScriptUtil;
import com.pcdd.sonovel.core.Source;
import com.pcdd.sonovel.model.AppConfig;
import com.pcdd.sonovel.model.Rule;
import com.pcdd.sonovel.util.ConfigUtils;
import org.jsoup.Jsoup;
import org.junit.jupiter.api.Test;

import java.util.Map;

/**
 * @author pcdd
 * Created at 2025/1/30
 */
class Rule6Test {

    public static final AppConfig config = ConfigUtils.config();

    @Test
    void crackSearch6() {
        String kw = "我吃西红柿";
        String js = ResourceUtil.readUtf8Str("js/rule-6.js");
        Object key = ScriptUtil.invoke(js, "getParamB", kw);

        Source source = new Source(config);
        Rule.Search ruleSearch = source.rule.getSearch();
        String param = ruleSearch.getData().formatted(kw, key);
        JSONObject obj = JSONUtil.parseObj(param);
        System.out.println(JSONUtil.toJsonPrettyStr(obj));

        Map<String, String> map = JSONUtil.toBean(param, Map.class);
        HttpRequest req = HttpRequest
                .get(ruleSearch.getUrl())
                .header("Referer", ruleSearch.getUrl() + "search.html")
                .formStr(map);

        System.out.println(req.form());
        String body = req.execute().body();
        String s = UnicodeUtil.toString(body);
        String s2 = HtmlUtil.unescape(s)
                .replace("\\r", "")
                .replace("\\n", "")
                .replace("\\t", "")
                .replace("\\/", "/")
                .replace("\\\"", "'");
        String s4 = ReUtil.getGroup0("\\{(.*?)\\}", s2);
        JSONObject jsonObject = JSONUtil.parseObj(s4);
        String html = jsonObject.getStr("content");
        System.out.println(Jsoup.parse(html));
    }

}