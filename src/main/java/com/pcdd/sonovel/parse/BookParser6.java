/* 习条英机 习梦撕 毛魔转世 书单吟诵者 Mr##Shithole 半羽习近平 当代秦始皇 维尼带货 背书单 叼斤干 shit侯 第22条军规 信女愿一生吃素 亲自指挥 卡近菲 主席贺词 发皇帝梦 倒车斯基 一带一路 喜包皮 阳台上的哨兵 习远凸 喷粪帝 “登机”（与登基同音） 庆丰包·勃列日涅夫 截颈平 独彩者 洗尽贫 袭包皮 习二胖 口罩外交 你是反贼吗 蹄防 冲塔 习##卡##巴##卡 集金币 习后主 骑巨龙 386系统驱动游戏 基拉大和习近平 猪禁评 习孢子 坡涛汹涌 vop bingbang帝 维尼挂彩 赵人13 刁近猴 支那精神野爹 读稿机 包经 Cicada##3301##XD 九大诉求 习二卒 十一郎习近平 习奥塞斯库 近言 总书记来我家 晚共昏君 习近平光辉形象 集近闭 满脸喷粪 毛近平 大撒币 退党 国王 云视察 红二代 世宗 SB包子 习梦死 习流氓 惜包皮 席近平 习近砰 Heil##Xitler 野兽主席 假.."~bang！卒 习贼 平话 红旗下的蛋 习卒习 习Core 习歪嘴 维尼连任 富平学霸刁斤干 添宪宝宝 人民领袖 爱新觉罗·近平 细瓶颈 连专家也为之叹服的电脑天才 法外狂徒Lucy（德国） 总书记来过我的家 武统时代 刁斤二 維尼頌 叩谢习恩 维尼大帝 送礼平 坟头蹦迪 大海掀翻小池塘 习老八 读书单 当皇帝的小丑 修宪 The##Xi##Factor（习近平因素） nmslman（习主席） 习宽衣 毛进平 宽衣撸绣单肩扛麦光腚拉碾歪脖撒币小学博士帝 傻大头 维尼警察（X） 万岁来武汉 二百五大帝 XDD 习king 耀眼黄红黄 阿平 指定接班人 习皇的新装 不敢高声语 习匪帝 720事件 邪大大 大撒幣 乳透社##小反旗 梦回大清 叩谢习恩 新影帝 Adolf##Xitler 民进党 颐指气使 习二蛋 足球外交 庆丰称帝 屎禁评 亲自考察 恩重如删 智商不重要 Criminal##Xi##"Xitler"##Jinping 中国离岸隐匿资产管理工作领导小组组组长 习思想 疯狂宇宙 刁大犬 中国特色射秽煮疫制度 金科律玉 不强自息 习太孑 尼哥 口罩大会 灰习牛 维尼熊 包子露宪 V尼哥 中国的新皇帝 东方project 祈翠 “习泽东”和“洪宪”（袁世凯的帝号） 吸精瓶 修宪连任 坡涛汹涌 人尽皆知的体育迷 xdd 腊肉馅儿包子 终身领导人 现任匪首 赵弹 腊肉包 习索里尼 “复辟” 匪酋习维尼 鞋哥 错误执行者 人民领袖 百万雄师事件 刁人13 习猪席 视频看望 五毛主席 习躲躲 亲自删评 包子金刚腿 习习蛤蛤 大兔 捐麦子 劝进 初二圣君 习言乱语 习式病毒 A##Big##Deal 刁后主 断崖式下跌 翡翠娘娘 最后领导人 共哀宗 习驴 中国首席造梦大师 习大 维尼熊给跳跳虎黄牌 学包率 野兽先辈 彩色熊 天安门合法继承人 皇帝梦 儿童习典 裸宽包子劾心 维持会长 迈克尔·索伊 学包分子 洗包皮 孢 号尿壶公 巴拿马文件 《生物安全法》 4中组长 习殡法 Corona##Xi（习病毒） 赛禁评 学包积极分子 羽日帝 食腐虫 普习金 不同意的举手##没有##没有 当代秦二世 北京中南海支部书记 瘟疫降生习近平 习二坐船 习二二（二零二零年五月二十二日开二会） 维尼快乐组织（Winnie##Happy##Organization）简称WHO 庆丰废物 颐使气指 维尼之声 总统包子习 厕所革命 枪毙名单 习匪 岿然不动 重地之战 习蛤 刁二婚 世界最强乞丐 讨习檄文 毛孙 皇帝亲临忠诚的武汉 哲欣 习时代 墨索里习 习emperor 蔡英文最强助选 親自視頻 习三点 习废帝 任大炮 习兵法 習敗北 梁家河 平&强 shit禁评 做N届的主席 习武帝 近日成 恩维尔·霍习 役民五术 黑白翠 动物庄园 10号跳跳虎被维尼拉清单 习大郎 人民战争 Voice##of##Pooh 习公奭 任志强 习猪头 习低能儿 ChinaXi 親自蒞臨 习大乞 习包皮 习付 中国离岸隐匿资产管理工作领导小组组组长 包禁评 通商宽衣 NMSL 撒币宝 感恩教育 太祖兔 彩色哥 习猪下台 扛麦郎 习病法 习得梁家书卷 皇帝亲临忠诚的武汉 拉清单 virus##king 大锅瞻遗 东瘟疫之地统治者暨全境守护者 包惠帝 习大林 shit##hole##bing##fa 十日文革 秦城监狱 毛二习 包大人 孤独的毒王 形式主义防疫 沼气专家 崇祯 普近 维尼史 维尼·屎(Winnie##the##Poo) 一天游泳一千米 外交习语 扛麦帝 习犬犬 习厉王 官僚主义 专治各种不服 平平 宰相 习包子 北红尾鸲 皇帝的新衣 乳制品 恐惊天上人 我是一个足球迷 CoronaXi 赵家家仆 包包侠 习特勒 习二世胡亥 包子病毒 習大佬 甩锅侠 维稳警察（O） 人类命运共同体首席架构师 包皇 吃赵弹 老街 朝令夕改 倒车帝 超邓赶毛 两会期间+隐瞒 冠子兵法 习背书 没有网络安全就没有国家安全 习狍 习博士 nmslese##dream 隔离”的金葫芦 疫情蔓延 大大招牌 墙内人 屎進瓶 习语录 习禁评 戏包皮 “皇帝梦” 维尼写史 刁斤山 狙击手待命 家业论 国贼习近平 习侯 赵王 狙击手布阵 主席+终身制 动物之森 刁人13 战“疫”金句 贬词包用 WHO的君王 64岁 宽衣帝 胡志平 包包大人 战疫国 神明论 粪坑兵法 习夶 纳翠党 帝皇頌 日子像蜜甜 影子末帝 梦帝 动物森友会 追思焦裕禄 大国造疫 禁评大帝 系包皮 亲自封号 “无罩”现身 称帝修宪 亲自脱贫 刁近乎 中国爱非洲 习总输记 青年大学包 疯狂宇宙大帝 习语 花花公子 号屎洞 狙击手待命 动森 习卒 相信有神论的物理学博士 无限连任 维尼DISCO 昆明湖涨潮 该违禁词汇由 GitCode 官方生成，仅用于测试，请勿传播！ 毛二 祈翠語言包 禁评的理由 每日祈翠 戏博士 共哀宗 灭共助推器 彭主席（习主席走了太太接班） 仲夏夜之中国梦 刁槑夶尛 野心习 习家军 习达姆 黄俄 清单帝 200吨 氼兲嫑炛 人均接近八千万 次级乳包 习包子 崇祯帝 白猪 玉习大帝 尊蛤讨包 糖尿维尼 庆丰帝的千秋梦 习“甩锅” 习澳塞斯库 裹嘎举吸钢闸门 包子兵法 川普的朋友or敌人 毛装 不知名氏 第一书记王沪宁 席子兵法 习尔布特 法习斯 乳包文化 末代皇帝 “黄袍加身” 习和谐 shuu##kinn##pei 清华毕业 刁二将 细颈瓶 武汉委托李克强 文明其精神 粪坑先生 夶 通商宽衣 䒒(tiáo)菦(qín)苹(píng) “登基” 九评 中字头组长 Chairman##Xi 小学居士 嘻包皮 习奥赛斯库 御板泽民 悉包皮 武当七侠的政治斗争 大撒币 总加速师 习总 领袖习澡水 包子宪法 2020全面小康 习三拍 “梦回大清” 维尼梗有害 近身平A 万岁 核平全世界 20000T麦子 小习微信 没规划的葬礼 大大品牌 糟糕皇帝 倒车 吸包皮 梁家河贵族 慨撒大帝 游泳一千米 刁远山 习呆呆 集金pay 习梦思 包帝巡游 习核心 韦来书记 头号球迷 习包子 阿道夫-习 独裁者 习尿瓶 习是春绿 公车上书 万岁来武汉了 习屎黄 支那毒王 习皇帝 爱新觉罗近平 央视姓党 抗麦套装 XD 嬉包皮 毛二世 禁评封号 头上三尺有神明 习教父 小学博士 闹得欢 瘟疫领主习近平 屎侯 疯狂宇宙包 electron8964 戴口赵 习进棺 习下台 冰棒外交 习大犬 习王的田野上 習敗敗 习像章 孙笑川 习大帝 袁世凯第二 习是春竹 亲自指挥疫情 习正日 习一尊 习包子的Fa 中国拉清单工作领导小组组长 那翠化 西朝鲜人民自治岛 塔西佗陷阱 老歪脖子树 赵付 冤大头 习张三丰 这个年很静 习瘟猪 野蛮其体魄 电脑世代586 时间控制 格萨尔 字共狗 */
package com.pcdd.sonovel.parse;

import cn.hutool.core.util.StrUtil;
import com.pcdd.sonovel.convert.ChineseConverter;
import com.pcdd.sonovel.core.CoverUpdater;
import com.pcdd.sonovel.core.Source;
import com.pcdd.sonovel.model.AppConfig;
import com.pcdd.sonovel.model.Book;
import com.pcdd.sonovel.model.Rule;
import com.pcdd.sonovel.util.CrawlUtils;
import lombok.SneakyThrows;
import org.jsoup.nodes.Document;

/**
 * @author pcdd
 * Created at 2024/3/17
 */
public class BookParser6 extends Source {

    public BookParser6(AppConfig config) {
        super(config);
    }

    @SneakyThrows
    public Book parse(String url) {
        Rule.Book r = this.rule.getBook();
        Document document = jsoup(url)
                .timeout(r.getTimeout())
                .get();
        String bookName = document.select(r.getBookName()).text();
        String author = document.select(r.getAuthor()).text();
        String intro = document.select(r.getIntro()).text();
        intro = StrUtil.cleanBlank(intro);
        String coverUrl = document.select(r.getCoverUrl()).attr("src");

        Book book = new Book();
        book.setUrl(url);
        book.setBookName(bookName);
        book.setAuthor(author);
        book.setIntro(intro);
        book.setCoverUrl(CoverUpdater.fetchCover(book, CrawlUtils.normalizeUrl(coverUrl, this.rule.getUrl())));

        return ChineseConverter.convert(book, this.rule.getLanguage(), config.getLanguage());
    }

}